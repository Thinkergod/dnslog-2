<!DOCTYPE html>
<html>
<head>
	<title>DNSLOG</title>
	<script src="/socket.io/socket.io.js"></script>
	<link rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/css/bootstrap.min.css">  
	<link href="https://cdn.bootcss.com/alertifyjs-alertify.js/1.0.10/css/alertify.css" rel="stylesheet">
	<script src="https://cdn.staticfile.org/jquery/2.1.1/jquery.min.js"></script>
	<script src="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>
	<script src="https://cdn.bootcss.com/alertifyjs-alertify.js/1.0.10/js/alertify.js"></script>
	<script src="https://cdn.bootcss.com/clipboard.js/2.0.4/clipboard.min.js"></script>
</head>
<body>
	<nav class="navbar navbar-default" role="navigation">
	<div class="container-fluid">
	<div class="navbar-header">
		<a class="navbar-brand" href="#">DNSLOG</a>
	</div>
	<div>
		<ul class="nav navbar-nav">
			<li class=""><a href="#">REBINDING(开发中)</a></li>
			<li class=""><a href="javascript:help();">使用方法</a></li>
			<li><a href="https://github.com/hackit-me/dnslog" target="__blank">开放源代码</a></li>
<!-- 			<li class="dropdown">
				<a href="#" class="dropdown-toggle" data-toggle="dropdown">
					Java
					<b class="caret"></b>
				</a>
				<ul class="dropdown-menu">
					<li><a href="#">jmeter</a></li>
					<li><a href="#">EJB</a></li>
					<li><a href="#">Jasper Report</a></li>
					<li class="divider"></li>
					<li><a href="#">分离的链接</a></li>
					<li class="divider"></li>
					<li><a href="#">另一个分离的链接</a></li>
				</ul>
			</li> -->
		</ul>
	</div>
	</div>
</nav>
<button class=" btn btn-primary btn-lg" onclick="init()" style="margin-left:200px;margin-top:50px;">Get A Random Domain</button>
<button id="copybutton" class="copy-domain btn btn-primary btn-lg" style="margin-top:50px;" disabled>Copy Domain</button>
<div class="jumbotron" style="margin-left:200px;margin-right:200px;margin-top:50px; ">
	<div class="container" id="log">
		
	</div>
</div>
<div id="footer" class="container">
<nav class="navbar navbar-default navbar-fixed-bottom">
    <div class="navbar-inner navbar-content-center">
        <p class="text-muted credit" style="padding-top: 14px;text-align: center;">
            Copyright © 2019 dnslog.io All Rights Reserved.
        </p>
    </div>
</nav>
<script>
	alertify.parent(document.body);
	alertify.logPosition('top center');
	var socket;
	var logEle = document.getElementById("log");
	var clipboard;
	function init(){
		flash();
		getDnslog();
	}
	function help(){
		alertify
		  .okBtn("ok")
		  .confirm("<h1>dnslog使用方法</h1></br><p>点击按钮获取随机域名（拷贝至剪贴板，如果浏览器不支持一键拷贝，可以手动拷贝dns)</br>去其他地方触发后可到本页面查看记录</p>", function (ev) {
		      ev.preventDefault();
		      alertify.success("OK");
		  });
	}
	function getDnslog(){
		var socketUrl = location.protocol + "//" + location.host;
		if(typeof(socket) !== "undefined" && socket !== ""){
			delete socket;console.log('delete');
		}
		socket = io.connect(socketUrl);
		socket.on('randomDomain', function (data) {
			// console.log(data.domain);
			copyValue(data.domain);
			log(currentTime());
			log("\tGet Domain: " + data.domain);
			// socket.emit('my other event', { my: 'data' });
			document.getElementById('copybutton').disabled = false;
		});
		socket.on('dnslog',function(data){
			console.log(data.dnslog);
			log(currentTime());
			log("\tGet DnsLog: " + data.dnslog);
			alertify.log("\tGet DnsLog: " + data.dnslog);
		});
	}
    function copyValue(val){
    	if(typeof(clipboard) !== "undefined"){
    		clipboard.destroy();
    	}
    	// console.log(val);
    	clipboard = new ClipboardJS('.copy-domain', {text: function(){return val}});
	    clipboard.on('success', function (e) {
	        alertify.success("Copy <font style='color:red;'>"+e.text+"</font> success!");
	    });
	    clipboard.on('error', function(e) {
	        alertify.error("Copy failed");
	    });
	}
	function flash(){
		logEle.innerHTML = "";
	}
	function log(val){
		logEle.innerHTML += val + "</br>";
	}
	function currentTime(){
		var day = new Date();
 		day.setDate(day.getDate());
 		return day;
	}
</script>
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?d9679ef04537bb0b7b0d1c28e86f1ca1";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>
</body>
</html>
